# üöÄ Alytn Arzuw - Backend (Laravel)

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—ç–∫–µ–Ω–¥ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏ –∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ Laravel 10 —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–ú–æ–¥–µ–ª–∏ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è](#–º–æ–¥–µ–ª–∏-–∏-–æ—Ç–Ω–æ—à–µ–Ω–∏—è)
- [–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏](#—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
- [–ü–æ–ª–∏—Ç–∏–∫–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è](#–ø–æ–ª–∏—Ç–∏–∫–∏-–∏-—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è)
- [–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å](#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Laravel 10** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π PHP —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **PHP 8.1+** - –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è PHP
- **MySQL/PostgreSQL** - —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Redis** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–µ—Å—Å–∏–∏
- **Laravel Sanctum** - API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Laravel Queue** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
- **Laravel Notifications** - —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **Laravel Policies** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
- **Eloquent ORM** - –æ–±—ä–µ–∫—Ç–Ω–æ-—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- PHP 8.1 –∏–ª–∏ –≤—ã—à–µ
- Composer 2.0+
- MySQL 8.0+ –∏–ª–∏ PostgreSQL 13+
- Redis 6.0+ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- Node.js 18+ (–¥–ª—è —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)

### PHP —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
php-bcmath
php-curl
php-dom
php-fileinfo
php-json
php-mbstring
php-mysql
php-openssl
php-pdo
php-tokenizer
php-xml
php-zip

# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
php-redis
php-memcached
php-gd
php-imagick
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone <repository-url>
cd alytn_arzuw
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
composer install
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp .env.example .env
php artisan key:generate
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –í .env —Ñ–∞–π–ª–µ
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=altyn_arzuw
DB_USERNAME=your_username
DB_PASSWORD=your_password

# –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
mysql -u root -p -e "CREATE DATABASE altyn_arzuw CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
```

### 5. –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥—ã
```bash
php artisan migrate
php artisan db:seed
```

### 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—ç—à–∞
```bash
php artisan config:cache
php artisan route:cache
php artisan view:cache
```

### 7. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
php artisan serve
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000`

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ Console/           # –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
‚îú‚îÄ‚îÄ DTOs/             # Data Transfer Objects
‚îú‚îÄ‚îÄ Enums/            # –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ Http/             # HTTP —Å–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/  # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ Middleware/   # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ü–û
‚îÇ   ‚îú‚îÄ‚îÄ Requests/     # –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ Resources/    # API —Ä–µ—Å—É—Ä—Å—ã
‚îú‚îÄ‚îÄ Models/           # Eloquent –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ Notifications/    # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ Observers/        # –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ Policies/         # –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞
‚îú‚îÄ‚îÄ Providers/        # –°–µ—Ä–≤–∏—Å-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
‚îú‚îÄ‚îÄ Repositories/     # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îî‚îÄ‚îÄ Services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

database/
‚îú‚îÄ‚îÄ migrations/       # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îî‚îÄ‚îÄ seeders/         # –°–∏–¥—ã –¥–∞–Ω–Ω—ã—Ö

routes/
‚îú‚îÄ‚îÄ api.php          # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ web.php          # Web –º–∞—Ä—à—Ä—É—Ç—ã
‚îî‚îÄ‚îÄ console.php      # –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```

## üîå API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
```http
POST /api/auth/login
Content-Type: application/json

{
    "username": "user@example.com",
    "password": "password"
}
```

#### –û—Ç–≤–µ—Ç
```json
{
    "user": {
        "id": 1,
        "username": "user@example.com",
        "name": "User Name",
        "roles": ["admin"]
    },
    "token": "1|abc123..."
}
```

### –ó–∞–∫–∞–∑—ã

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
```http
GET /api/orders?page=1&per_page=20&search=keyword
Authorization: Bearer {token}
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
```http
POST /api/orders
Authorization: Bearer {token}
Content-Type: application/json

{
    "client_id": 1,
    "product_id": 1,
    "quantity": 5,
    "deadline": "2024-12-31",
    "price": 1000.00
}
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
```http
PUT /api/orders/{id}
Authorization: Bearer {token}
Content-Type: application/json

{
    "quantity": 10,
    "price": 2000.00
}
```

### –ö–ª–∏–µ–Ω—Ç—ã

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
```http
GET /api/clients?page=1&search=company
Authorization: Bearer {token}
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
```http
POST /api/clients
Authorization: Bearer {token}
Content-Type: application/json

{
    "name": "Company Name",
    "company_name": "Company LLC",
    "contacts": [
        {
            "type": "email",
            "value": "contact@company.com"
        }
    ]
}
```

### –ü—Ä–æ–¥—É–∫—Ç—ã

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
```http
GET /api/products?page=1&search=product
Authorization: Bearer {token}
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
```http
POST /api/products
Authorization: Bearer {token}
Content-Type: application/json

{
    "name": "Product Name",
    "description": "Product description",
    "price": 500.00
}
```

## üóÑÔ∏è –ú–æ–¥–µ–ª–∏ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è

### Order (–ó–∞–∫–∞–∑)
```php
class Order extends Model
{
    protected $fillable = [
        'client_id',
        'project_id',
        'product_id',
        'stage_id',
        'quantity',
        'deadline',
        'price',
        'work_type',
        'reason',
        'reason_status',
        'is_archived',
        'archived_at'
    ];

    // –û—Ç–Ω–æ—à–µ–Ω–∏—è
    public function client() {
        return $this->belongsTo(Client::class);
    }

    public function product() {
        return $this->belongsTo(Product::class);
    }

    public function project() {
        return $this->belongsTo(Project::class);
    }

    public function stage() {
        return $this->belongsTo(Stage::class);
    }

    public function assignments() {
        return $this->hasMany(OrderAssignment::class);
    }
}
```

### Client (–ö–ª–∏–µ–Ω—Ç)
```php
class Client extends Model
{
    protected $fillable = [
        'name',
        'company_name'
    ];

    public function contacts() {
        return $this->hasMany(ClientContact::class);
    }

    public function orders() {
        return $this->hasMany(Order::class);
    }
}
```

### User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
```php
class User extends Authenticatable
{
    protected $fillable = [
        'name',
        'username',
        'email',
        'password',
        'is_active'
    ];

    public function roles() {
        return $this->belongsToMany(Role::class, 'user_roles');
    }

    public function assignments() {
        return $this->hasMany(OrderAssignment::class);
    }
}
```

## üè™ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

### OrderRepository
```php
class OrderRepository
{
    public function getPaginatedOrders(Request $request, User $user): LengthAwarePaginator
    {
        $cacheKey = 'orders_' . $user->id . '_' . md5($request->fullUrl());
        
        return Cache::remember($cacheKey, 300, function () use ($request, $user) {
            $query = Order::with(['project', 'product', 'client', 'stage']);
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–∞–≤–∞–º –¥–æ—Å—Ç—É–ø–∞
            if (!$user->hasAnyRole(['admin', 'manager'])) {
                $assignedOrderIds = OrderAssignment::query()
                    ->where('user_id', $user->id)
                    ->pluck('order_id');
                $query->whereIn('id', $assignedOrderIds);
            }
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
            $this->applyFilters($query, $request);
            
            return $query->paginate($request->input('per_page', 30));
        });
    }
}
```

### ClientRepository
```php
class ClientRepository
{
    public function getPaginatedClients(Request $request, User $user): LengthAwarePaginator
    {
        $query = Client::with('contacts');
        
        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–∞–≤–∞–º –¥–æ—Å—Ç—É–ø–∞
        if (!$user->hasAnyRole(['admin', 'manager'])) {
            $assignedClientIds = $this->getAssignedClientIds($user);
            $query->whereIn('id', $assignedClientIds);
        }
        
        return $query->paginate($request->input('per_page', 30));
    }
}
```

## üîê –ü–æ–ª–∏—Ç–∏–∫–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### OrderPolicy
```php
class OrderPolicy
{
    public function viewAny(User $user): bool
    {
        return $user->hasAnyRole(['admin', 'manager', 'user']);
    }

    public function view(User $user, Order $order): bool
    {
        // –ê–¥–º–∏–Ω—ã –∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –≤–∏–¥—è—Ç –≤—Å–µ –∑–∞–∫–∞–∑—ã
        if ($user->hasAnyRole(['admin', 'manager'])) {
            return true;
        }
        
        // –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
        return $order->assignments()->where('user_id', $user->id)->exists();
    }

    public function create(User $user): bool
    {
        return $user->hasAnyRole(['admin', 'manager']);
    }

    public function update(User $user, Order $order): bool
    {
        return $user->hasAnyRole(['admin', 'manager']);
    }
}
```

### ClientPolicy
```php
class ClientPolicy
{
    public function viewAny(User $user): bool
    {
        return $user->hasAnyRole(['admin', 'manager', 'user']);
    }

    public function view(User $user, Client $client): bool
    {
        if ($user->hasAnyRole(['admin', 'manager'])) {
            return true;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–∫–∞–∑—ã —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
        return $client->orders()
            ->whereHas('assignments', function ($query) use ($user) {
                $query->where('user_id', $user->id);
            })
            ->exists();
    }
}
```

## üíæ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
```php
// –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
$cacheKey = 'orders_' . $user->id . '_' . md5($request->fullUrl());
$cacheTime = 300; // 5 –º–∏–Ω—É—Ç

return Cache::remember($cacheKey, $cacheTime, function () {
    // –î–æ—Ä–æ–≥–æ–π –∑–∞–ø—Ä–æ—Å –∫ –ë–î
    return $this->executeExpensiveQuery();
});
```

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
```php
// –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ—á–∏—â–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫—ç—à
public function updateOrder(Order $order, array $data): OrderDTO
{
    $order->update($data);
    
    // –û—á–∏—â–∞–µ–º –∫—ç—à –∑–∞–∫–∞–∑–æ–≤
    Cache::flush();
    
    return OrderDTO::fromModel($order);
}
```

### Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```env
CACHE_DRIVER=redis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379
```

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ N+1 –ø—Ä–æ–±–ª–µ–º

**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (N+1 –ø—Ä–æ–±–ª–µ–º–∞):**
```php
// ‚ùå –ü–ª–æ—Ö–æ - N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
$orders = Order::all();
foreach ($orders as $order) {
    echo $order->client->name; // –ù–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞
}
```

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```php
// ‚úÖ –•–æ—Ä–æ—à–æ - 1 –∑–∞–ø—Ä–æ—Å —Å JOIN
$orders = Order::with(['client', 'product', 'stage'])->get();
foreach ($orders as $order) {
    echo $order->client->name; // –î–∞–Ω–Ω—ã–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
}
```

### –ò–Ω–¥–µ–∫—Å—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```sql
-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
CREATE INDEX idx_orders_client_id ON orders(client_id);
CREATE INDEX idx_orders_stage_id ON orders(stage_id);
CREATE INDEX idx_orders_created_at ON orders(created_at);
CREATE INDEX idx_order_assignments_user_id ON order_assignments(user_id);
CREATE INDEX idx_order_assignments_order_id ON order_assignments(order_id);
```

### –ü–∞–≥–∏–Ω–∞—Ü–∏—è
```php
// –í—Å–µ API endpoints –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é
return $query->paginate($request->input('per_page', 30));
```

### –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
```php
// –ò—Å–ø–æ–ª—å–∑—É–µ–º with() –¥–ª—è eager loading
$order = Order::with([
    'client.contacts',
    'product.stages',
    'assignments.user.roles'
])->find($id);
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Laravel Sanctum** –¥–ª—è API —Ç–æ–∫–µ–Ω–æ–≤
- JWT-–ø–æ–¥–æ–±–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **Policies** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- **Middleware** –¥–ª—è –∑–∞—â–∏—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤
- **Gates** –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞

### –í–∞–ª–∏–¥–∞—Ü–∏—è
```php
// –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
public function store(CreateOrderRequest $request)
{
    $validated = $request->validated();
    // –î–∞–Ω–Ω—ã–µ —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
}
```

### –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –¥–ª—è web –º–∞—Ä—à—Ä—É—Ç–æ–≤
- API –º–∞—Ä—à—Ä—É—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã —Ç–æ–∫–µ–Ω–∞–º–∏

### Rate Limiting
```php
// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
Route::middleware(['throttle:60,1'])->group(function () {
    Route::post('/auth/login', [AuthController::class, 'login']);
});
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
php artisan test

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
php artisan test tests/Unit/OrderTest.php

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
php artisan test --coverage
```

### Feature —Ç–µ—Å—Ç—ã
```php
class OrderApiTest extends TestCase
{
    use RefreshDatabase;

    public function test_can_create_order()
    {
        $user = User::factory()->create();
        $client = Client::factory()->create();
        $product = Product::factory()->create();

        $response = $this->actingAs($user)
            ->postJson('/api/orders', [
                'client_id' => $client->id,
                'product_id' => $product->id,
                'quantity' => 5
            ]);

        $response->assertStatus(201);
        $this->assertDatabaseHas('orders', [
            'client_id' => $client->id,
            'product_id' => $product->id,
            'quantity' => 5
        ]);
    }
}
```

### Database —Ç–µ—Å—Ç—ã
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
php artisan test --env=testing
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Production –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```env
APP_ENV=production
APP_DEBUG=false
APP_URL=https://your-domain.com

DB_CONNECTION=mysql
DB_HOST=production-db-host
DB_DATABASE=production_db
DB_USERNAME=prod_user
DB_PASSWORD=secure_password

CACHE_DRIVER=redis
QUEUE_CONNECTION=redis
SESSION_DRIVER=redis
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
```bash
# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
php artisan config:cache

# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤
php artisan route:cache

# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π
php artisan view:cache

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑—á–∏–∫–∞
composer install --optimize-autoloader --no-dev
```

### Supervisor –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π
```ini
[program:laravel-worker]
process_name=%(program_name)s_%(process_num)02d
command=php /path/to/project/artisan queue:work --sleep=3 --tries=3
autostart=true
autorestart=true
user=www-data
numprocs=8
redirect_stderr=true
stdout_logfile=/path/to/project/storage/logs/worker.log
```

### Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /path/to/project/public;

    add_header X-Frame-Options "SAMEORIGIN";
    add_header X-Content-Type-Options "nosniff";

    index index.php;

    charset utf-8;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }

    error_page 404 /index.php;

    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php8.1-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        include fastcgi_params;
    }

    location ~ /\.(?!well-known).* {
        deny all;
    }
}
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```php
// –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
Log::info('Order created', [
    'order_id' => $order->id,
    'user_id' => $user->id,
    'client_id' => $order->client_id
]);
```

### Health checks
```php
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
Route::get('/health', function () {
    return response()->json([
        'status' => 'healthy',
        'timestamp' => now(),
        'database' => DB::connection()->getPdo() ? 'connected' : 'disconnected',
        'cache' => Cache::store()->get('health_check') ? 'working' : 'not working'
    ]);
});
```

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```php
// –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
DB::enableQueryLog();
// ... –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
$queries = DB::getQueryLog();
Log::info('Query performance', ['queries' => $queries]);
```

## üîß –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
```bash
# –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –∫—ç—à–µ–π
php artisan cache:clear

# –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
php artisan config:clear

# –û—á–∏—Å—Ç–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
php artisan route:clear

# –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π
php artisan view:clear
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏
```bash
# –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π
php artisan migrate

# –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏
php artisan migrate:rollback

# –°–±—Ä–æ—Å –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π
php artisan migrate:reset

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π
php artisan migrate:refresh
```

### –°–∏–¥—ã
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–∏–¥–æ–≤
php artisan db:seed

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–∏–¥–∞
php artisan db:seed --class=UserSeeder

# –ó–∞–ø—É—Å–∫ —Å–∏–¥–æ–≤ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
php artisan migrate:fresh --seed
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Laravel Documentation](https://laravel.com/docs)
- [Laravel Sanctum](https://laravel.com/docs/sanctum)
- [Eloquent ORM](https://laravel.com/docs/eloquent)
- [Laravel Policies](https://laravel.com/docs/authorization)
- [Laravel Queue](https://laravel.com/docs/queues)
- [Laravel Notifications](https://laravel.com/docs/notifications)

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —Å–∏—Å—Ç–µ–º—ã Alytn Arzuw –∏ –∑–∞—â–∏—â–µ–Ω –∞–≤—Ç–æ—Ä—Å–∫–∏–º –ø—Ä–∞–≤–æ–º.

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:

- –°–æ–∑–¥–∞–π—Ç–µ Issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ API

---

**–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –∫–æ–º–∞–Ω–¥–æ–π LTM**
